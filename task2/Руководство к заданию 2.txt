КРАТКОЕ РУКОВОДСТВО ПО ИСПОЛЬЗОВАНИЮ СКРИПТА
«Изохроны по сети УДС»


Для работы скрипта нужны слои:

– Граф УДС (линейный слой), например:
  • удс_геометрия.gpkg (для авто/велосипеда/пешком).
– Пешеходный/велосипедный граф (если используете отдельные сети).
– Изолинии рельефа (линии с высотами), например:
  • SRTM_Irkutsk_Lines_Interval_1.shp (поле VALUE – отметка высоты).
– Здания с населением (точки или полигоны с полем населения), например:
  • Здания_насел_attract.shp (поле «Насел»).


НАСТРОЙКА ПАРАМЕТРОВ

Обязательные/основные параметры:

– Граф улично-дорожной сети (INPUT_NETWORK)
  Выберите слой линейной сети (удс_геометрия.gpkg или аналогичный).

– Режим движения (MODE)
  0 – Пешком (учёт рельефа при заданных изолиниях),
  1 – Велосипед,
  2 – Авто.

– Интервалы времени (INTERVALS)
  Список минут через запятую, например:
  10,20,30
  Для каждого интервала будет построен свой полигон доступности.

– Стартовая точка (START_POINT)
  Нажмите кнопку справа от поля, выберите «Задать на карте» и щёлкните в нужном месте города (жилой дом, школа и т.п.).

– Буфер вокруг линий (BUFFER_DIST)
  Толщина зоны вокруг достижимых дорог в метрах (по умолчанию 50).
  При 50 м изохрона выглядит как «толстые улицы».
  Для более «заполненных» зон можно задать 100–200 м.


Учёт населения (опционально):

– Слой населения (POP_LAYER)
  Выберите слой зданий с населением (Здания_насел_attract.shp).

– Поле с населением (POP_FIELD)
  Выберите поле с числом жителей (например, «Насел»).

Если слой/поле не заданы, скрипт будет считать только площадь изохрон.


Изолинии рельефа (для пешего режима):

– Слой изолиний (CONTOURS)
  Выберите слой SRTM_Irkutsk_Lines_Interval_1.shp (или перепроецированный аналог в CRS сети).

– Поле высоты (CONTOURS_Z)
  Укажите поле с высотой, например VALUE.

При режиме «Пешком» скрипт:
1) строит DEM (цифровую модель высот) из изолиний;
2) переносит высоту на рёбра сети;
3) рассчитывает скорость по формуле с учётом перепада высот:
   меньшая скорость на крутых подъёмах/спусках.


Поля скорости для режимов (по желанию):

– Поле скорости ПЕШКОМ (WALK_SPEED_FIELD)
  Можно оставить пустым – тогда скорость 4 км/ч, скорректированная по уклонам.
– Поле скорости ВЕЛОСИПЕД (BIKE_SPEED_FIELD)
– Поле скорости АВТО (CAR_SPEED_FIELD)
  Если указать поля, содержащие числовую скорость (км/ч), скрипт будет использовать их; если пусто – берётся постоянная скорость:
  вело 15 км/ч, авто 20 км/ч (можно изменить в коде).


УЧЁТ ПОДХОДА К СЕТИ

Если стартовая точка не лежит на дороге, скрипт:
– находит расстояние от неё до ближайшей линии сети;
– переводит это расстояние в минуты пешком (4 км/ч);
– вычитает это время из заданных интервалов (10/20/30 мин) и строит изохроны по сети только на оставшееся время.

В логе алгоритма выводится:
– расстояние до сети (м),
– время подхода (мин).


6. РЕЗУЛЬТАТЫ

Скрипт создаёт три выходных слоя:

1) Изохроны (OUTPUT) – MultiPolygon
   Атрибуты:
   – id      – номер интервала,
   – t_min   – интервал времени (мин),
   – mode    – режим («Пешком», «Велосипед», «Авто»),
   – area_km2 – площадь полигона (км²),
   – pop_sum – суммарное население в зоне (если задан слой населения).

   Рекомендуемая символика:
   – символизация по уникальным значениям поля t_min;
   – 10 мин – зелёный, 20 – жёлтый, 30 – оранжевый, с полупрозрачной заливкой.

2) Точка старта (OUTPUT_START) – Point
   Одна точка с полями:
   – id,
   – mode.

3) Пешеходная сеть (OUTPUT_WALKNET) – LineString
   Копия сети (для пешего режима – с учётом высоты).
   Атрибуты:
   – все поля исходной сети,
   – поле walk_spd (км/ч) – рассчитанная скорость на ребре с учётом перепада высот.

   Можно использовать для проверки:
   – открыть таблицу,
   – посмотреть разброс значений walk_spd (около 4 на ровных участках и ниже на уклонах).
